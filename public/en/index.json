


[{"content":"","date":"5. September 2024","externalUrl":null,"permalink":"/tags/dns/","section":"Tags","summary":"","title":"Dns","type":"tags"},{"content":" DNS # grober Überblick der Arbeitsschritte # drei Linux VMs installieren (Debian) auf allen bind installieren alle bind konfigurieren mit Ansible automatisieren Ziele # drei DNS Server miteinander verbinden und eine Kaskade bilden einen mittleren DNS konfigurieren, der alle Zonen kennt Anleitung # Diese Aufgabe setzt Debain vorraus. Mit entsprechenden Anpassungen ist alles mit anderen Distributionen möglich. Die Installation vom Debian-System wird hier ebenfalls nicht behandelt. Dies muss alleine passieren. Wenn beide Debian-VM\u0026rsquo;s installiert sind und miteinander kommunizieren können, kann mit den Aufgaben begonnen werden. Für Informationen empfehle ich die bind9-Doku und die Debian-Doku.\nbind installieren # Mit folgendem Befehl könnt ihr bind und dig installieren:\napt install bind9 dnsutils bind konfigurieren allgemein # wichtige Dateien:\n/etc/bind/named.conf /var/lib/bind/azubi.dataport.de.zone Bei Debian wird im Standart die named.conf in mehrere Dateien aufgespaltet. In dieser Übung ist das aber nicht notwendig, da wir nur eine kleine named.confbrauchen, die auch in einer Datei übersichtlich. Falls ihr die Datei trotzdem aufteilen wollt, ist das mit dem include-Befehl möglich.\n... include \u0026#34;/etc/bind/named.conf.options\u0026#34;; ... Troubleshooting # Zum Troubleshooting könnt ihr folgendes veruschen:\njournalctl -eu named.service für logs named-checkconf um die named.confzu validieren named-checkzone azubi.dataport.de /var/lib/bind/azubi.dataport.de.zone um die Zonen Config zu validieren bind konfigurieren auf ns1 # Die erste Aufgabe ist es, ns1 zu konfigurieren. Das Ziel dabei soll es sein, Einträge aus azubi.dataport.de auflösen zu können und auch vom Upstream DNS google.de. Dazu muss eine Zone generiert werden und die named.conf angepasst werden. Um die Config zu validieren könnt ihr den Befehl named-checkconf verwenden. Bei der Zone hilft euch der Befehl named-checkzone azubi.dataport.de /var/lib/bind/azubi.dataport.de.zone. In der azubi.dataport.de Zone soll es einen ns1, server Eintrag geben und einen CNAME mail auf server. IP-Adressen könnt ihr euch dabei selbst ausdenken.\nAnbei sind die Lösungen, falls ihr nicht mehr weiter wisst. Die Configs können auch anders aussehen und sind unten nur minimal/beispielhaft.\nZum testen eurer Umgebung könnt ihr den Befehl dig benutzen (nslookup ist auch möglich). Was funktionieren sollte:\nroot@ns1# dig +noall +answer google.de @localhost google.de. 283 IN A 142.250.181.195 root@ns1# dig +noall +answer mail.azubi.dataport.de @localhost mail.azubi.dataport.de. 3600 IN CNAME server.azubi.dataport.de. server.azubi.dataport.de. 3600 IN A 192.168.0.2 Lösung azubi.dataport.de.zone + $ORIGIN azubi.dataport.de. $TTL 3600 @ IN SOA ns1.azubi.dataport.de. root.azubi.dataport.de. ( 2007010401 ; Serial 3600 ; Refresh [1h] 600 ; Retry [10m] 86400 ; Expire [1d] 600 ) ; Negative Cache TTL [1h] @ IN NS ns1.azubi.dataport.de. ns1 IN A 192.168.0.1 server IN A 192.168.0.2 mail IN CNAME server [!example]- Lösung named.conf\nacl goodclients { localhost; localnets; };\noptions { listen-on { 0.0.0.0; }; directory \u0026ldquo;/var/cache/bind\u0026rdquo;;\nforward only; forwarders { 1.1.1.1; };\ndnssec-validation yes; allow-query { goodclients; }; };\nzone \u0026ldquo;azubi.dataport.de\u0026rdquo; IN { type primary; file \u0026ldquo;/var/lib/bind/azubi.dataport.de.zone\u0026rdquo;; allow-update { none; }; };\nbind konfigurieren auf ns2 # Das ganze soll jetzt auch auf ns2 passieren. Als Herausforderung für euch werde ich hier keine weiteren Informationen geben. Aus der Grafik sollte entnommen werden können, wie der Aufbau aussehen soll.\nZum testen eurer Umgebung könnt ihr wieder den Befehl dig benutzen (nslookup ist auch möglich). Was funktionieren sollte:\nroot@ns2# dig +noall +answer google.de @localhost google.de. 78 IN A 142.250.180.67 root@ns2# dig +noall +answer mail.azubi.dataport.de @localhost mail.azubi.dataport.de. 3600 IN CNAME server.azubi.dataport.de. server.azubi.dataport.de. 3600 IN A 192.168.0.2 root@ns2# dig +noall +answer debian.olli.azubi.dataport.de @localhost debian.olli.azubi.dataport.de. 3600 IN A 192.168.2.2 [!example]- Lösung olli.azubi.dataport.de.zone\n$ORIGIN olli.azubi.dataport.de. $TTL 3600 @ IN SOA ns2.olli.azubi.dataport.de. root.olli.azubi.dataport.de. ( 2007010401 ; Serial 3600 ; Refresh [1h] 600 ; Retry [10m] 86400 ; Expire [1d] 600 ) ; Negative Cache TTL [1h]\n@ IN NS ns2.olli.azubi.dataport.de.\nns2 IN A 192.168.2.1 debian IN A 192.168.2.2\n[!example]- Lösung named.conf\nacl goodclients { localhost; localnets; };\noptions { listen-on { 0.0.0.0; }; directory \u0026ldquo;/var/cache/bind\u0026rdquo;;\nforward only; forwarders { 192.168.0.1; };\ndnssec-validation yes; allow-query { goodclients; }; };\nzone \u0026ldquo;olli.azubi.dataport.de\u0026rdquo; IN { type primary; file \u0026ldquo;/var/lib/bind/olli.azubi.dataport.de.zone\u0026rdquo;; allow-update { none; }; };\nredirect Zone # Damit die name.azubi.dataport.de Zone auf dem ns1 auflösbar ist, gibt es folgende Möglichkeiten:\neine secondary Zone eine forward Zone auf ns1 Bei der secondary Zone muss die Config auf ns1 und auf ns2 angepasst werden. Eine forward Zone braucht nur eine Anpassung auf ns1. Daraus resultieren noch weitere Vor- und Nachteile. Beide Varianten haben aber die Anwendungszwecke. Ihr könnt euch für eine der beiden Varianten entscheiden und diese dann einrichten. Lösungen haben ich für beide Varianten. secondary Zone # Für eine secondary Zone müsst ihr auf ns2 den Transfer der Zone erlauben. Danach könnt ihr die Zone auf ns1 anlegen und transferieren. Hier noch ein paar Befehle die euch helfen können:\nrndc reload um im bind einen reload der Zonen zu machen und damit einen Transfer der Zone [!example]- Lösung named.conf ns1\n\u0026hellip; zone \u0026ldquo;olli.azubi.dataport.de\u0026rdquo; IN { type secondary; file \u0026ldquo;/var/lib/bind/olli.azubi.dataport.de.saved\u0026rdquo;; allow-notiy { 192.168.2.1; }; primaries { 192.168.2.1; }; };\n[!example]- Lösung named.conf ns2\nWichtig ist hier, in der Zone die serial zu erhöhen bei jeder Änderung.\n\u0026hellip; zone \u0026ldquo;olli.azubi.dataport.de\u0026rdquo; IN { type primary; file \u0026ldquo;/var/lib/bind/olli.azubi.dataport.de.zone\u0026rdquo;; allow-update { none; }; notify yes; also-notify { 192.168.0.1; }; allow-transfer { 192.168.0.1; }; };\nforward # Die forward Zone wird einfach auf ns1 in der named.conf angelegt und schickt sämtliche Anfrage von der Domäne an den forwarder.\n[!example]- Lösung named.conf forward Zone\n\u0026hellip; zone \u0026ldquo;olli.azubi.dataport.de\u0026rdquo; IN { type forward; forward only; forwarders { 192.168.2.1; }; };\n","date":"5. September 2024","externalUrl":null,"permalink":"/fisi/dns/","section":"FiSis","summary":"","title":"DNS","type":"fisi"},{"content":"","date":"5. September 2024","externalUrl":null,"permalink":"/tags/example/","section":"Tags","summary":"","title":"Example","type":"tags"},{"content":"","date":"5. September 2024","externalUrl":null,"permalink":"/tags/fisi/","section":"Tags","summary":"","title":"Fisi","type":"tags"},{"content":"","date":"5. September 2024","externalUrl":null,"permalink":"/fisi/","section":"FiSis","summary":"","title":"FiSis","type":"fisi"},{"content":"","date":"5. September 2024","externalUrl":null,"permalink":"/tags/tag/","section":"Tags","summary":"","title":"Tag","type":"tags"},{"content":"an example to get you started\nThis is a heading # This is a subheading # This is a subsubheading # This is a subsubsubheading # This is a paragraph with bold and italic text. Check more at Blowfish documentation undefined\n","date":"5. September 2024","externalUrl":null,"permalink":"/fisi/1725525700149-test/","section":"FiSis","summary":"","title":"test","type":"fisi"},{"content":"","externalUrl":null,"permalink":"/en/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/en/","section":"Blog","summary":"","title":"Blog","type":"page"},{"content":"","externalUrl":null,"permalink":"/en/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/en/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/en/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"}]